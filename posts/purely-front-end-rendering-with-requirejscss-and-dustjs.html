<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/png" href="/assets/favicon.png">

  <title>Purely Front End rendering with RequireJS/CSS and DustJS</title>
  <meta name="description" content="IntroductionBy using RequireJS as file loading engine, and DustJS as the rendering engine, one can easily create a purely Front-end rendering web-page/site, ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://flyfy1.github.io/posts/purely-front-end-rendering-with-requirejscss-and-dustjs.html">
  <link rel="alternate" type="application/rss+xml" title="Yangyu's Notes" href="https://flyfy1.github.io/feed.xml">
  
</head>


  <body>
    

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Yangyu's Notes</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <a class="page-link" href="/about">About</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Purely Front End rendering with RequireJS/CSS and DustJS</h1>
    <p class="post-meta">
      <time datetime="2013-06-24T00:00:00+08:00" itemprop="datePublished">Jun 24, 2013</time>
      
      
      <span>web</span>
      
      <span>front-end</span>
      
      <span>javascript</span>
      
    </p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h2 id="introduction">Introduction</h2>
<p>By using RequireJS as file loading engine, and DustJS as the rendering engine, one can easily create a purely Front-end rendering web-page/site, with only these contents in the front page:</p>
<div id="index-code"></div>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;title&gt;</span>Testing Front-End Rendering<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">data-main=</span><span class="s">"scripts/main.js"</span> <span class="na">src=</span><span class="s">"http://requirejs.org/docs/release/2.1.6/minified/require.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span></code></pre></figure>

<p>The source file is <a href="/pages/frontendRender">here</a>. By Viewing the source you can see everything.</p>

<p>But I have to put this in the first place that.. aside from thinking it to be interesting, <strong>I cannot see much practical use of this technique yet</strong>.</p>

<h2 id="setup">Setup</h2>
<p>In order to achieve this, here are the required files:</p>
<ul>
  <li><a href="http://requirejs.org/docs/release/2.1.6/minified/require.js">RequireJS</a></li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>[RequireJS</td>
          <td>Text!](https://github.com/requirejs/text/blob/master/text.js)</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li><a href="https://raw.github.com/akdubya/dustjs/master/lib/">DustJS</a>, need the files below:
    <ul>
      <li>dust.js</li>
      <li>compiler.js</li>
      <li>parser.js</li>
    </ul>
  </li>
  <li><a href="https://github.com/guybedford/require-css">RequireCSS</a> (Optional)</li>
  <li><a href="http://twitter.github.io/bootstrap/">BootStrap</a> (Optional)</li>
</ul>

<h2 id="online-tutorials">Online Tutorials</h2>
<p>For the tutorial on each of them, you may google online, or refer to:</p>
<ul>
  <li>RequireJS(http://requirejs.org/docs/api.html): supports dynamic loading of JavaScript files, as well</li>
  <li>RequireCss(https://github.com/guybedford/require-css): plugin to the RequireJS, supports dynamic loading of css files.</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>RequireJS</td>
          <td>Text!(https://github.com/requirejs/text): plugin to RequireJS, supports dynamic loading of any file as plain-text</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>DustJS(http://akdubya.github.io/dustjs/): Template Engine supports both front-end and back-end rendering</li>
</ul>

<h2 id="details">Details</h2>
<p>As you can see in the <a href="#index-code">above</a>, the only thing import is this line:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html">  <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">data-main=</span><span class="s">"scripts/main.js"</span> <span class="na">src=</span><span class="s">"http://requirejs.org/docs/release/2.1.6/minified/require.js"</span><span class="nt">&gt;&lt;/script&gt;</span></code></pre></figure>

<p>This is to include the <code class="language-plaintext highlighter-rouge">Require.JS</code> file, and load the <code class="language-plaintext highlighter-rouge">scripts/main.js</code> file, which all the logic resides in.</p>

<p>Now comes the <code class="language-plaintext highlighter-rouge">scripts/main.js</code> file:</p>

<div id="code-requirejs-config" />

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">requirejs</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
  <span class="na">baseUrl</span><span class="p">:</span> <span class="dl">"</span><span class="s2">scripts</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">paths</span><span class="p">:{</span>
    <span class="na">jquery</span><span class="p">:</span> <span class="dl">"</span><span class="s2">//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">dustJS</span><span class="p">:</span> <span class="dl">"</span><span class="s2">//raw.github.com/akdubya/dustjs/master/lib/dust</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">views</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">../views</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">map</span><span class="p">:</span> <span class="p">{</span>  <span class="c1">// code for requireCss plugin</span>
    <span class="dl">'</span><span class="s1">*</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span>
      <span class="dl">'</span><span class="s1">css</span><span class="dl">'</span><span class="p">:</span><span class="dl">'</span><span class="s1">./requirecss/css</span><span class="dl">'</span>
    <span class="p">},</span>
  <span class="p">},</span>
<span class="p">});</span>

<span class="nx">require</span><span class="p">([</span><span class="dl">"</span><span class="s2">prepareFront</span><span class="dl">"</span><span class="p">]);</span></code></pre></figure>

<p>It does two things here:</p>

<ol>
  <li>Config the requirejs</li>
  <li>Calls the <code class="language-plaintext highlighter-rouge">scripts/prepareFront.js</code> file.</li>
</ol>

<p>In order to understand step#1, we need to first understand how requireJS actually works.</p>

<div class="well">

<h4> RequireJS Basic Concepts </h4>
<p> Whenever we want to include a file using RequireJS, we would do: </p>


<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">require</span><span class="p">([</span><span class="dl">"</span><span class="s2">file1</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">file2</span><span class="dl">"</span><span class="p">],</span><span class="kd">function</span><span class="p">(){</span>
  <span class="c1">// Callback function comes here, main logic</span>
<span class="p">});</span></code></pre></figure>


<p>
file1, file2 are the <b>required files</b> needed before called the callback function, where path is the relative path, based
on the `baseUrl` (configured above in the [config][code-front] part) to your JavaScript source.
Thus the complete path to the file is: `baseUrl\file` 
</p>
<p>
A example using require function would be the [prepareFront.js](#code-prepareFront) file.
</p>
</div>

<p>The <code class="language-plaintext highlighter-rouge">paths</code> in the <a href="#code-requirejs-config">config</a> part are to config alternative parent paths, and these alternative path are
based on my baseUrl path. Say my file structure is like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>| scripts/
| | dust/
| | requirecss/
| | | css.js
| | | normalize.js
| | main.js
| | prepareFront.js
| | require.js
| | text.js
| views/
| | layout.dust
| | main.dust
| index.html
</code></pre></div></div>

<p>as defined <a href="#code-requirejs-config">above</a>, the baseUrl is <code class="language-plaintext highlighter-rouge">scripts</code>. Thus, if I want to refer to <code class="language-plaintext highlighter-rouge">views/</code> folder, the path setup
would be <code class="language-plaintext highlighter-rouge">../views</code>. More detailed explaination are on the RequireJS tutorial site.</p>

<p>After understanding the above, let’s move on to the “map” part of the config code. I don’t quite understand what it
means yet but it simply worked. The <code class="language-plaintext highlighter-rouge">'css':'./requirecss/css'</code> is pointing to the require-css folder. So that each time
one wants to load any css file, he can simply do:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">require</span><span class="p">([</span><span class="dl">"</span><span class="s2">css!pathToCss</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">css!anotherCssFile</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">a/normal/js/import/can/be/added/here/also</span><span class="dl">"</span><span class="p">]);</span></code></pre></figure>

<p>For most of the time there is no action required after loading the css file, thus no function is required here.</p>

<p>After the config being done, let’s move on to the <code class="language-plaintext highlighter-rouge">prepareFront.js</code> part:</p>

<div id="code-prepareFront" />

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// FILE: prepareFront.js</span>
<span class="nx">require</span><span class="p">([</span>
  <span class="dl">"</span><span class="s2">jquery</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">css!//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.js</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">dust/dust</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">dust/compiler</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">dust/parser</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">text!views/main.dust</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">text!views/layout.dust</span><span class="dl">"</span><span class="p">,</span>
<span class="p">],</span><span class="kd">function</span><span class="p">(){</span>
  <span class="kd">var</span> <span class="nx">main</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">6</span><span class="p">];</span>
  <span class="kd">var</span> <span class="nx">layout</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">[</span><span class="mi">7</span><span class="p">];</span>
  <span class="nx">dust</span><span class="p">.</span><span class="nx">loadSource</span><span class="p">(</span><span class="nx">dust</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">layout</span><span class="p">,</span><span class="dl">"</span><span class="s2">layout</span><span class="dl">"</span><span class="p">));</span>
  <span class="nx">dust</span><span class="p">.</span><span class="nx">loadSource</span><span class="p">(</span><span class="nx">dust</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nx">main</span><span class="p">,</span><span class="dl">"</span><span class="s2">content</span><span class="dl">"</span><span class="p">));</span>

  <span class="kd">var</span> <span class="nx">srcObj</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">nav</span><span class="p">:{</span>
      <span class="na">name</span><span class="p">:</span><span class="dl">"</span><span class="s2">Songyy</span><span class="dl">"</span><span class="p">,</span>
      <span class="na">bar</span><span class="p">:[</span><span class="dl">"</span><span class="s2">Link 1</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Link 2</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Link 3</span><span class="dl">"</span><span class="p">],</span>
      <span class="na">dropdown</span><span class="p">:[</span><span class="dl">"</span><span class="s2">Drop 1</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Drop 2</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Drop 3</span><span class="dl">"</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="na">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">lu lalal</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">};</span>

  <span class="nx">dust</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="dl">"</span><span class="s2">layout</span><span class="dl">"</span><span class="p">,</span><span class="nx">srcObj</span><span class="p">,</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">dta</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">){</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">dta</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">});</span></code></pre></figure>

<p>This file defines the main logic.
It would first get all the require done(jQuery, bootstrap - optional to make things look better, DustJS, and layout
files), then do a front-end rendering of the dust-js file. For details about the dust-js syntax, you may refer to the
[dust js tutorial site](http://akdubya.github.io/dustjs/). That site is pretty complete ;)</p>

<p>Here it marks the end of this implementation part.</p>

<h2 id="discussion--pros--cons">Discussion – Pros &amp; Cons</h2>

<h3 id="cons">Cons</h3>
<p>I’ll put reasons for not using (purely) front-end rendering here:</p>

<h4 id="1-its-bad-for-seosearch-engine-optimization">1. It’s bad for SEO(Search-Engine-Optimization).</h4>
<p>As far as I know, most Robots cannot process JavaScript well. By having dynamically loaded content, the search
   engine’s robots would wrongly believe that your site has nothing, because there’s nothing static.</p>

<h4 id="2-its-unstable">2. It’s unstable.</h4>
<p>By using JavaScript loading means.. if there’s any line of code having any small error, or the user’s browser
   disabled JavaScript, or there’s any problem with the loading of any required library, the user would end up with
   seeing nothing. This would greatly affect the user experience in <code class="language-plaintext highlighter-rouge">certain countries</code> where the internet access to
   certain website (like Google) are not so stable.</p>

<h3 id="pros">Pros</h3>

<p>And I guess here’re some good points of using Front-end Rendering:</p>

<h3 id="1-save-the-computation-power-of-the-server-side">1. Save the computation power of the server side.</h3>
<p>This doesn’t seems to be so important since server is so cheap these days, and customers usually means everything.</p>

<h3 id="2-having-a-univeral-template-when-ajax-is-a-must">2. Having a univeral template when Ajax is a must</h3>
<p>This is the only reason I can see, for using front-end rendering. A bit hard to explain though:</p>

<p>Say this website have to use AJax to dynamically load certain data and creating some contents using templates on the
   fly, in that context front-end rendering is unavailable.</p>

<p>If the front-end template is another file which is different from the backend template of the same content, you
   end-up having two duplicate generating the same content. This is definitely a bad coding exercise because everytime
   you need to update the styling, you would have to update the two templates.</p>

<p>Two choices left in this context – either do a purely front-end rendering, or a purely back-end. A back-end
   rendering might consume some lot more bandwidth than the front-end rendering, and that where a front-end rendering is
   needed.</p>

<p>Oh.. if one can actually use the same template for both the front-end and back-end, then life would be easier.</p>


  </div>

  <div class="ad-section">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- first-test -->
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-4310544384247370"
         data-ad-slot="5532160063"
         data-ad-format="auto"></ins>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>
</article>

<comments>
  

</comments>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Yangyu's Notes</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Yangyu's Notes</li>
          <li><a href="mailto:flyfy1@gmail.com">flyfy1@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/flyfy1"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">flyfy1</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/songyangyu"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">songyangyu</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>This is the ideas from Yangyu Song.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
